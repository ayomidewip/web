/* ===== Image Component CSS ===== */
/* Minimal styling - lets the image speak for itself */

.themed-image {
	/* Minimal container - no extra spacing */
	line-height: 0; /* Remove line-height spacing */
	font-size: 0; /* Remove font-size spacing */
}

.themed-image img {
	/* Reset any browser defaults */
	border: none;
	outline: none;
	vertical-align: top;
	/* Smooth transitions for non-edit mode */
	transition: filter 0.2s ease, transform 0.2s ease, opacity 0.3s ease;
}

/* Edit mode - disable transitions for instant feedback */
.themed-image.edit-mode img {
	transition: none;
}

/* Ensure FAB doesn't interfere with image dimensions */
.themed-image .fab-container {
	position: absolute;
	pointer-events: none;
}

.themed-image .fab-container .floating-action-button {
	pointer-events: auto;
}

/* Edit border and drag handles */
.image-edit-border {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	pointer-events: none;
	transform-origin: center center;
	box-sizing: border-box;
}

.image-edit-border.dragging {
	transition: none;
}

.image-edit-border:not(.dragging) {
	transition: transform 0.1s ease;
}

/* Base drag handle styles */
.drag-handle {
	position: absolute;
	pointer-events: auto;
	transition: transform 0.2s ease, box-shadow 0.2s ease;
	user-select: none;
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
	/* Reset parent transform to prevent warping */
	transform-origin: center;
}

.drag-handle:hover {
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.drag-handle:active {
	cursor: grabbing !important;
}

/* Rotation handle - extended from top */
.rotation-handle {
	top: -32px;
	left: 50%;
	width: 16px;
	height: 16px;
	background-color: var(--primary-color);
	border: 2px solid var(--background-color);
	border-radius: 50%;
	cursor: grab;
	z-index: 10;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
	/* Counter parent scale to maintain perfect circle */
	transform: translateX(-50%) scale(var(--handle-scale-x, 1), var(--handle-scale-y, 1));
}

.rotation-handle:hover {
	box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
}

/* Rotation connector line */
.rotation-connector {
	position: absolute;
	top: -32px;
	left: 50%;
	width: 2px;
	height: 28px;
	background-color: var(--primary-color);
	pointer-events: none;
	z-index: 9;
	/* Counter parent scale to maintain line width */
	transform: translateX(-50%) scaleX(var(--handle-scale-x, 1));
}

/* Corner handles for resizing */
.corner-handle {
	width: 12px;
	height: 12px;
	background-color: var(--primary-color);
	border: 2px solid var(--background-color);
	border-radius: 50%;
	z-index: 10;
}

.corner-handle.top-left {
	top: -6px;
	left: -6px;
	cursor: nwse-resize;
	/* Counter parent scale to maintain perfect circle */
	transform: scale(var(--handle-scale-x, 1), var(--handle-scale-y, 1));
}

.corner-handle.top-right {
	top: -6px;
	right: -6px;
	cursor: nesw-resize;
	transform: scale(var(--handle-scale-x, 1), var(--handle-scale-y, 1));
}

.corner-handle.bottom-left {
	bottom: -6px;
	left: -6px;
	cursor: nesw-resize;
	transform: scale(var(--handle-scale-x, 1), var(--handle-scale-y, 1));
}

.corner-handle.bottom-right {
	bottom: -6px;
	right: -6px;
	cursor: nwse-resize;
	transform: scale(var(--handle-scale-x, 1), var(--handle-scale-y, 1));
}

/* Edge handles for resizing */
.edge-handle {
	background-color: var(--primary-color);
	border: 1px solid var(--background-color);
	border-radius: 4px;
	z-index: 10;
}

.edge-handle.top {
	top: -4px;
	left: 50%;
	width: 40px;
	height: 8px;
	cursor: ns-resize;
	/* Counter parent scale to maintain shape */
	transform: translateX(-50%) scale(var(--handle-scale-x, 1), var(--handle-scale-y, 1));
}

.edge-handle.bottom {
	bottom: -4px;
	left: 50%;
	width: 40px;
	height: 8px;
	cursor: ns-resize;
	transform: translateX(-50%) scale(var(--handle-scale-x, 1), var(--handle-scale-y, 1));
}

.edge-handle.left {
	left: -4px;
	top: 50%;
	width: 8px;
	height: 40px;
	cursor: ew-resize;
	transform: translateY(-50%) scale(var(--handle-scale-x, 1), var(--handle-scale-y, 1));
}

.edge-handle.right {
	right: -4px;
	top: 50%;
	width: 8px;
	height: 40px;
	cursor: ew-resize;
	transform: translateY(-50%) scale(var(--handle-scale-x, 1), var(--handle-scale-y, 1));
}

/* Crop overlay system */
.crop-overlay {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	transform-origin: center center;
}

.crop-overlay-mask {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	pointer-events: none;
}

.crop-overlay-mask svg {
	position: absolute;
}

/* Crop grid box */
.crop-grid {
	position: absolute;
	border: 2px solid var(--primary-color);
	cursor: move;
	pointer-events: auto;
}

/* Crop grid lines */
.crop-grid-line {
	position: absolute;
	background-color: rgba(255, 255, 255, 0.5);
	pointer-events: none;
}

.crop-grid-line.horizontal {
	left: 0;
	width: 100%;
	height: 1px;
}

.crop-grid-line.vertical {
	top: 0;
	width: 1px;
	height: 100%;
}

/* Crop handles - corners */
.crop-handle {
	position: absolute;
	background-color: var(--primary-color);
	z-index: 10;
}

.crop-handle.crop-handle-nw,
.crop-handle.crop-handle-ne,
.crop-handle.crop-handle-sw,
.crop-handle.crop-handle-se {
	width: 12px;
	height: 12px;
	border: 2px solid var(--background-color);
	border-radius: 50%;
}

.crop-handle.crop-handle-nw {
	top: -6px;
	left: -6px;
	cursor: nwse-resize;
}

.crop-handle.crop-handle-ne {
	top: -6px;
	right: -6px;
	cursor: nesw-resize;
}

.crop-handle.crop-handle-sw {
	bottom: -6px;
	left: -6px;
	cursor: nesw-resize;
}

.crop-handle.crop-handle-se {
	bottom: -6px;
	right: -6px;
	cursor: nwse-resize;
}

/* Crop handles - edges */
.crop-handle.crop-handle-n,
.crop-handle.crop-handle-s {
	left: 50%;
	width: 40px;
	height: 8px;
	border: 1px solid var(--background-color);
	border-radius: 4px;
	cursor: ns-resize;
}

.crop-handle.crop-handle-n {
	top: -4px;
}

.crop-handle.crop-handle-s {
	bottom: -4px;
}

.crop-handle.crop-handle-w,
.crop-handle.crop-handle-e {
	top: 50%;
	width: 8px;
	height: 40px;
	border: 1px solid var(--background-color);
	border-radius: 4px;
	cursor: ew-resize;
}

.crop-handle.crop-handle-w {
	left: -4px;
}

.crop-handle.crop-handle-e {
	right: -4px;
}

/* Crop action buttons container */
.crop-actions {
	position: absolute;
	bottom: 10px;
	left: 50%;
	transform: translateX(-50%);
	display: flex;
	gap: var(--spacing-sm);
	z-index: 10;
}

/* Responsive image sizing */
@media (max-width: 480px) {
	.themed-image {
		max-width: 100%;
	}
}
